var synkitApp=angular.module("synkApp",["ngRoute","ngAnimate","firebase","pagination"]);synkitApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/home.html",controller:"HomeController",resolve:{currentAuth:["Auth",function(e){return e.$waitForSignIn()}]}}).when("/auth/signup",{templateUrl:"views/auth/signup.html",controller:"AuthController"}).when("/auth/signin",{templateUrl:"views/auth/signin.html",controller:"AuthController"}).when("/user/category",{templateUrl:"views/category.html",controller:"CategoryController",resolve:{currentAuth:["Auth",function(e){return e.$waitForSignIn()}]}}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location",function(e,t){e.$on("$locationChangeStart",function(r,o,a){firebase.auth().onAuthStateChanged(function(r){r?e.user=r:t.path("/auth/signin")})})}]).service("appService",["$firebaseAuth",function(e){this.getCurrentUser=function(){return e().$getAuth()}}]).factory("Auth",["$firebaseAuth",function(e){return e()}]).controller("HomeController",["$scope","$firebaseArray","$rootScope","appService","currentAuth",function(e,t,r,o,a){e.pageTitle="Home page",e.addModalRequest=!1,e.editModalRequest=!1,e.url="",e.titleError="",e.urlError="",e.orderProperty="title",e.sortByTitle=!0,e.sortByCategory=!1,e.sortByDate=!1,e.loading=!0;var n=o.getCurrentUser();const i=firebase.database().ref().child(n.uid),l=i.child("categories"),d=i.child("bookmarks");e.bookmarks=t(d),e.categories=t(l),e.categories.$loaded().then(function(){e.loading=!1}),e.showAddBookmarkModal=function(){e.addModalRequest=!0},e.addBookmark=function(t){e.formData=angular.copy(t);var r=e.formData.title,o=e.formData.url,a=e.formData.urlCategory;if(!r||!o)return r||(e.titleError="Please enter a valid title"),void(o||(e.urlError="Please enter a valid Url"));var n=new Date,i=n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear(),l={title:r,url:o,category:a,modified:i};l.categoryName=e.categories.$getRecord(a).name,e.bookmarks.$add(l),e.addModalRequest=!1,t.title="",t.urlCategory="",t.url=""},e.deleteBookamrk=function(t){e.bookmarks.$remove(t)},e.editBookmarkRequest=function(t){e.form={},e.editModalRequest=!0,e.form.title=t.title,e.form.url=t.url,e.form.id=t.$id,e.form.urlCategories=e.categories,e.form.urlCategory=e.categories.$getRecord(t.category).$id},e.editBookmark=function(t){e.formData=angular.copy(t);var r=e.formData.title,o=e.formData.url;if(!r||!o)return r||(e.titleError="Please enter a valid title"),void(o||(e.urlError="Please enter a valid Url"));var a=new Date,n=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),i=e.formData.id,l=e.bookmarks.$getRecord(i);l.title=r,l.url=o,l.modified=n,l.category=e.formData.urlCategory,l.categoryName=e.categories.$getRecord(e.formData.urlCategory).name,e.bookmarks.$save(l),e.titleError="",e.urlError="",e.editModalRequest=!1,t.title="",t.urlCategory="",t.url=""},e.cancelModal=function(){e.addModalRequest=!1,e.editModalRequest=!1,e.titleError="",e.urlError=""},e.setOrderProperty=function(t){e.orderProperty===t?e.orderProperty="-"+t:(e.orderProperty,e.orderProperty=t),"title"===t?(e.sortByTitle=!0,e.sortByCategory=!1,e.sortByDate=!1):"categoryName"===t?(e.sortByTitle=!1,e.sortByCategory=!0,e.sortByDate=!1):(e.sortByTitle=!1,e.sortByCategory=!1,e.sortByDate=!0)}}]).controller("AuthController",["$scope","$location","$rootScope",function(e,t,r){e.error="",e.windowWidth=document.documentElement.clientWidth,window.onresize=function(){e.$apply(function(){e.windowWidth=document.documentElement.clientWidth})},e.signInWithGoogle=function(){var o=new firebase.auth.GoogleAuthProvider;o.addScope("https://www.googleapis.com/auth/plus.login"),firebase.auth().signInWithPopup(o).then(function(e){var o=(e.credential.accessToken,e.user);console.log(o),r.$apply(function(){t.path("/")})}).catch(function(t){var o=(t.code,t.message,t.email);t.credential;e.error='"'+o+'" is already registered with different authentication method',r.$apply()})},e.signInWithFacebook=function(){var t=new firebase.auth.FacebookAuthProvider;firebase.auth().signInWithPopup(t).then(function(e){e.credential.accessToken,e.user}).catch(function(t){var o=(t.code,t.message,t.email);t.credential;e.error='"'+o+'" is already registered with different authentication method',r.$apply()})},e.signOut=function(){firebase.auth().signOut().then(function(){r.$apply(function(){t.path("/auth/signin")})}).catch(function(e){})}}]).controller("CategoryController",["$scope","$rootScope","$firebaseAuth","$firebaseArray","appService","currentAuth",function(e,t,r,o,a,n){e.pageTitle="Category Page",e.addCategoryModalRequest=!1,e.editCategoryModalRequest=!1,e.categoryError="",e.loading=!0,e.sortByName=!0,e.sortByDate=!1,e.orderProperty="name";var i=a.getCurrentUser();const l=firebase.database().ref().child(i.uid),d=l.child("categories");var u=o(d);e.categories=u,e.categories.$loaded().then(function(){e.loading=!1}),e.showAddCategoryModal=function(){e.addCategoryModalRequest=!0},e.editCategoryShow=function(t){e.formData={},e.editCategoryModalRequest=!0,e.formData.id=t.$id,e.formData.name=t.name},e.deleteCategory=function(t){e.categories.$remove(t)},e.cancelModal=function(){e.addCategoryModalRequest=!1,e.editCategoryModalRequest=!1,e.categoryError=""},e.addCategory=function(t){var r=new Date,o=r.getDate()+"/"+(r.getMonth()+1)+"/"+r.getFullYear();if(!t)return void(e.categoryError="Please enter a valid name");var a=angular.copy(t),n=a.name;e.addCategoryModalRequest=!1,a.name="",e.categoryError="",u.$add({name:n,modified:o}).then(function(e){var r=e.key;console.log(t),t.name="",console.log("added with id",r)})},e.editCategory=function(){var t=new Date,r=e.formData.name;if(r){var o=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear(),a=e.formData.id,n=e.categories.$getRecord(a);n.name=r,n.modified=o,e.categories.$save(n),e.formData.name="",e.editCategoryModalRequest=!1}},e.setOrderProperty=function(t){e.orderProperty===t?e.orderProperty="-"+t:(e.orderProperty,e.orderProperty=t),"name"===t?(e.sortByName=!0,e.sortByDate=!1):"modified"===t&&(e.sortByName=!1,e.sortByDate=!0)}}]);